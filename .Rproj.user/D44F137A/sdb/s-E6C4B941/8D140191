{
    "collab_server" : "",
    "contents" : "#' @export\n\n#####################################################################\n##\n## A wrapper function for ESS_RegressionCalc written by Jaejoon Song\n##\n#####################################################################\n\n\ness <- function(model,label=NULL,prior=NULL,ncov=NULL,m=NULL,nsim=NULL,svec1=NULL,svec2=NULL){\n\n  modelStatement <- switch(EXPR = model,\n                           'betaBin' = 'beta-binomial',\n                           'Betabin' = 'beta-binomial',\n                           'betabin' = 'beta-binomial',\n                           'BetaBin' = 'beta-binomial',\n                           'gammaEx' = 'gamma-exponential',\n                           'Gammaex' = 'gamma-exponential',\n                           'gammaex' = 'gamma-exponential',\n                           'GammaEx' = 'gamma-exponential',\n                           'dirMult' = 'dirichlet-multinomial',\n                           'Dirmult' = 'dirichlet-multinomial',\n                           'dirmult' = 'dirichlet-multinomial',\n                           'DirMult' = 'dirichlet-multinomial',\n  )\n\n  if(model %in% c('betaBin','Betabin','betabin','BetaBin')){\n    label <- c('alpha','beta')\n    overall_out_label <- paste(\"(\",paste(label,collapse=\",\"),\")\",sep=\"\")\n    myESS <- as.numeric(prior[2]) + as.numeric(prior[3])\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS was calculated for a \",modelStatement,\" model\", sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS for the beta\",overall_out_label,\" prior is: \",myESS, sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(\"\\n\")\n  }\n\n\n  if(model %in% c('gammaEx','Gammaex','gammaex','GammaEx')){\n    label <- c('alpha','beta')\n    overall_out_label <- paste(\"(\",paste(label,collapse=\",\"),\")\",sep=\"\")\n    myESS <- as.numeric(prior[3])\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS was calculated for a \",modelStatement,\" model\", sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS for the gamma\",overall_out_label,\" prior is: \",myESS, sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(\"\\n\")\n  }\n\n\n  if(model %in% c('dirMult','Dirmult','dirmult','DirMult')){\n    label <- 'alpha1'\n    for(i in 2:(length(prior)-1)){# i <- 1\n      label <- c(label,paste('alpha',i,sep=\"\"))\n    }\n\n    overall_out_label <- paste(\"(\",paste(label,collapse=\",\"),\")\",sep=\"\")\n    myESS <- sum(as.numeric(prior[2:length(prior)]))\n\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS was calculated for a \",modelStatement,\" model\", sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS for the dirichlet\",overall_out_label,\" prior is: \",myESS, sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(\"\\n\")\n  }\n\n  if(model %in% c('linreg','Linreg','logistic','Logistic')){\n    default_prior <- list(c(1,0,1000),c(1,0,1000),c(1,0,1000),\n                          c(1,0,1000),c(1,0,1000),c(1,0,1000),\n                          c(1,0,1000),c(1,0,1000),c(1,0,1000),\n                          c(1,0,1000),c(1,0,1000),c(1,0,1000))\n\n    if(length(svec1)<12){svec1 <- c(svec1,rep(0,(12-length(svec1))))}\n    if(length(svec2)<12){svec2 <- c(svec2,rep(0,(12-length(svec2))))}\n\n    if(model=='linreg'){model <- 1}\n    if(model=='logistic'){model <- 2}\n\n    for(i in 1:length(prior)){\n      prior[[i]][prior[[i]] %in% c('norm','normal','N','Norm','Normal')] <- 1\n      prior[[i]][prior[[i]] %in% c('gamma','Gamma','Gam','gam')] <- 2\n      prior[[i]] <- as.numeric(prior[[i]])\n    }\n\n    for(i in 1:length(default_prior)){\n      assign(paste('Prior_',(i-1),sep=''),default_prior[[i]])\n    }\n\n    if(length(prior)>0){\n      for(i in 1:length(prior)){\n        assign(paste('Prior_',(i-1),sep=''),prior[[i]])\n      }\n    }\n\n    if(is.null(label)){\n      svec <- svec1 + svec2\n      svec[1] <- 1\n      label <- 'theta1'\n      for(i in 2:sum(svec)){\n        label <- c(label,paste('theta',i,sep=\"\"))\n      }\n    }\n\n    svec1_label <- svec1[1:length(label)]\n    svec2_label <- svec2[1:length(label)]\n\n    svec1_label <- label[which(svec1_label==1)]\n    svec2_label <- label[which(svec2_label==1)]\n\n    overall_out_label <- paste(\"(\",paste(label,collapse=\",\"),\")\",sep=\"\")\n    svec1_out_label <- paste(\"(\",paste(svec1_label,collapse=\",\"),\")\",sep=\"\")\n    svec2_out_label <- paste(\"(\",paste(svec2_label,collapse=\",\"),\")\",sep=\"\")\n\n    myESS <- ESS_RegressionCalc (Reg_model = model, Num_cov = ncov,\n                                 Prior_0 = Prior_0, Prior_1 = Prior_1, Prior_2 = Prior_2,\n                                 Prior_3 = Prior_3, Prior_4 = Prior_4, Prior_5 = Prior_5,\n                                 Prior_6 = Prior_6, Prior_7 = Prior_7, Prior_8 = Prior_8,\n                                 Prior_9 = Prior_9, Prior_10 = Prior_10, Prior_11 = Prior_11,\n                                 M = m, NumSims = nsim,\n                                 theta_sub1=svec1, theta_sub2=svec2 )\n\n    ESSoutput <- list(ESSoverall = myESS$ESSwholetheta,\n                      ESSsubvec1 = myESS$ESSsubvector1,\n                      ESSsubvec2 = myESS$ESSsubvector2\n    )\n\n    modelStatement <- switch(EXPR = model, 'linreg' = 'linear regression',\n                             'logistic' = 'logistic regression')\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESS was calculated for a \",modelStatement,\" model\", sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESSoverall: Overall ESS for the whole vector \",overall_out_label, sep=\"\")))\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESSsubvector1: ESS for the first sub-vector \",svec1_out_label, sep=\"\")))\n    cat(\"\\n\")\n    cat(noquote(paste(\"ESSsubvector1: ESS for the second sub-vector \",svec2_out_label, sep=\"\")))\n    cat(\"\\n\")\n    cat(\"\\n\")\n\n    ESSoutput\n  }\n\n}\n",
    "created" : 1513106738412.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3018191994",
    "id" : "8D140191",
    "lastKnownWriteTime" : 1513111362,
    "last_content_update" : 1513111362494,
    "path" : "Z:/My documents/1packages/ess/R/ess.R",
    "project_path" : "R/ess.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}